<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA de Consulta de Sa√∫de - Debug</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #f0f0f0;
            margin: 0;
        }
        .container {
            text-align: center;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            width: 300px;
        }
        .mic-button {
            font-size: 24px;
            cursor: pointer;
            background-color: transparent;
            border: none;
            color: #007bff;
            outline: none;
            margin-top: 10px;
        }
        .mic-button:active {
            color: red;
        }
        #status {
            font-size: 14px;
            color: gray;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>IA de Consulta de Sa√∫de</h2>
        <p>Pressione e segure o bot√£o de microfone para fazer uma pergunta.</p>
        
        <!-- Bot√£o para gravar √°udio -->
        <button class="mic-button" onmousedown="iniciarGravacao()" onmouseup="pararGravacao()">üé§</button>
        
        <div id="status">Aguardando...</div>
        <div id="resposta-ia" style="margin-top: 10px;"></div>
    </div>

    <script>
        let recognition;
        const synth = window.speechSynthesis;
        let isRecording = false;

        // Verificar suporte para reconhecimento de voz
        if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.lang = 'pt-BR';
            recognition.interimResults = false;
            recognition.continuous = false;

            // Evento disparado quando o reconhecimento de voz √© conclu√≠do
            recognition.onresult = (event) => {
                const pergunta = event.results[0][0].transcript.toLowerCase().trim();
                console.log("Texto capturado:", pergunta);  // Log no console para depura√ß√£o
                document.getElementById('status').innerText = "Pergunta capturada: " + pergunta;
                responderPergunta(pergunta); // Responder com √°udio
            };

            recognition.onerror = (event) => {
                console.error("Erro no reconhecimento de voz:", event.error);
                document.getElementById('status').innerText = "Erro no reconhecimento de voz";
            };
        } else {
            alert("Seu navegador n√£o suporta reconhecimento de voz. Tente usar o Chrome ou Edge.");
        }

        function iniciarGravacao() {
            if (recognition && !isRecording) {
                recognition.start();
                isRecording = true;
                document.getElementById('status').innerText = "Gravando... solte para finalizar.";
            }
        }

        function pararGravacao() {
            if (recognition && isRecording) {
                recognition.stop();
                isRecording = false;
                document.getElementById('status').innerText = "Processando pergunta...";
            }
        }

        function responderPergunta(pergunta) {
            let resposta = "Desculpe, n√£o entendi sua pergunta.";

            // Respostas para sauda√ß√µes e apresenta√ß√£o
            if (/bom dia|boa tarde|boa noite/.test(pergunta)) {
                resposta = "Ol√°! Meu nome √© IA Eliza Inteligencia Artificial. Como posso ajudar voc√™? Se precisar de assist√™ncia de emerg√™ncia, diga 'socorro' ou 'emerg√™ncia'. " +
                           "Para emerg√™ncias espec√≠ficas, voc√™ pode ligar para: Bombeiros no 193, SAMU no 192, ou Pol√≠cia no 190.";
            } else if (/socorro|emerg√™ncia|emergencia/.test(pergunta)) {
                resposta = "Para emerg√™ncias: Bombeiros ligue 193, SAMU ligue 192, e Pol√≠cia ligue 190. Estou aqui para ajudar com d√∫vidas de sa√∫de.";
            }
            // Respostas para sintomas espec√≠ficos com informa√ß√µes adicionais contextuais
            else if (/dor no peito/.test(pergunta)) {
                resposta = "Dor no peito pode ser um sinal de infarto. Se a dor for intensa ou persistente, procure atendimento m√©dico imediatamente.";
            } else if (/dor no bra√ßo direito/.test(pergunta)) {
                resposta = "Desconforto ou dor no bra√ßo direito, especialmente se acompanhado de dor no peito, pode ser indicativo de infarto. Consulte um m√©dico rapidamente.";
            } else if (/dor de cabe√ßa/.test(pergunta)) {
                resposta = "Dores de cabe√ßa podem ter v√°rias causas, como enxaqueca ou problemas neurol√≥gicos. Se a dor for persistente, procure um m√©dico.";
            } else if (/press√£o alta/.test(pergunta)) {
                resposta = "A press√£o alta aumenta o risco de AVC. √â importante monitorar regularmente e buscar ajuda m√©dica. A press√£o arterial ideal √© abaixo de 120/80 mmHg.";
            } else if (/press√£o baixa/.test(pergunta)) {
                resposta = "Press√£o baixa pode causar tonturas e, em casos graves, risco de desmaio ou at√© infarto. A press√£o arterial ideal √© 120/80 mmHg.";
            }

            // Exibir e falar a resposta
            document.getElementById('resposta-ia').innerText = resposta;
            falarTexto(resposta); // Responder em √°udio
        }

        function falarTexto(texto) {
            if (synth && !synth.speaking) {
                const utterance = new SpeechSynthesisUtterance(texto);
                utterance.lang = 'pt-BR';
                synth.speak(utterance);
            } else if (!synth) {
                alert("Seu navegador n√£o suporta s√≠ntese de voz.");
            }
        }
    </script>
</body>
</html>
